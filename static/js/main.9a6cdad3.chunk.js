(this["webpackJsonpatcoder-marathon-replay-frontend"]=this["webpackJsonpatcoder-marathon-replay-frontend"]||[]).push([[0],{197:function(e,t,n){},342:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(55),s=n.n(c),i=(n(196),n(197),n(74)),o=n(20),l=n(356),u=n(357),h=n(358),j=n(21),d=n(350),p=n(351),x=n(352),m=n(353),b=n(354),f=n(165),O=n(360),g=n(362),v=n(361),y=n(345),k=n(349),_=n(184),w=n(31),S=n(185),D=n(79),C=n(76),M=n(187),F=n(182),T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",n=e.getFullYear().toString(),r=("0"+(1+e.getMonth())).slice(-2),a=("0"+e.getDate()).slice(-2),c=("0"+e.getHours()).slice(-2),s=("0"+e.getMinutes()).slice(-2),i=("0"+e.getSeconds()).slice(-2);return t.replace(/YYYY/g,n).replace(/MM/g,r).replace(/DD/g,a).replace(/hh/g,c).replace(/mm/g,s).replace(/ss/g,i)},A=n(90),U=n(91),N=function(){function e(t){Object(A.a)(this,e),this.data=void 0,this.length=void 0,this.length=t,this.data=Array(++t).fill(0)}return Object(U.a)(e,[{key:"sum",value:function(e){var t=0;for(++e;e>0;e-=e&-e)t+=this.data[e];return t}},{key:"add",value:function(e,t){for(++e;e<this.data.length;e+=e&-e)this.data[e]+=t}},{key:"query",value:function(e,t){return this.sum(t-1)-this.sum(e-1)}}]),e}(),B=function(){function e(){Object(A.a)(this,e),this.taskScoreMap=void 0,this.score=void 0,this.afterTargetUser=void 0,this.taskScoreMap=new Map,this.score=0,this.afterTargetUser=!1}return Object(U.a)(e,[{key:"addSubmission",value:function(e){var t=e.score;if(this.taskScoreMap.has(e.task)){var n=this.taskScoreMap.get(e.task);if(n>t)return;this.score+=t-n}else this.score+=t;this.taskScoreMap.set(e.task,t)}}]),e}(),E=function(e,t){if(!t.some((function(t){return t.user_name===e})))return[];var n,r=new Set;r.add(0);var a=new Map;t.forEach((function(e){var t;a.has(e.user_name)?null===(t=a.get(e.user_name))||void 0===t||t.push(e):a.set(e.user_name,[e])})),n=a.size,a.forEach((function(e,t){var n=new B;e.forEach((function(e){n.addSubmission(e),r.add(n.score)}))}));var c=Array.from(r.values());c.sort((function(e,t){return e-t}));var s=new Map;c.forEach((function(e,t){s.set(e,t)}));var i=new N(c.length);i.add(s.get(0),n);var o=0,l=1,u=[],h=new Map;return t.forEach((function(t){if(!h.has(t.user_name)){var n=new B;n.afterTargetUser=!0,h.set(t.user_name,n)}var r=h.get(t.user_name),a=r.score;r.addSubmission(t);var j=r.score;if(j!==a){var d=s.get(a),p=s.get(j);if(i.add(d,-1),i.add(p,1),t.user_name===e)o=j,l=i.query(p,c.length),u.push({user:e,type:"update",time_unix:t.time_unix,rank:l,score:j,oldScore:a,task:t.task,status:t.status});else{if(j<o)return void(r.afterTargetUser=!1);if(j===o)return void(r.afterTargetUser=!0);if(a>o)return void(r.afterTargetUser=!1);if(a===o&&!r.afterTargetUser)return;u.push({user:e,type:"overtook",time_unix:t.time_unix,rank:++l,score:o,overtakeUserName:t.user_name,overtakeUserOldScore:a,overtakeUserNewScore:j,task:t.task,status:t.status}),r.afterTargetUser=!1}}})),u},Y=n(3),R=function(e){var t=e.index,n=e.x,r=e.y,a=e.color,c=e.rankChartDataSequence;if(void 0===t)return Object(Y.jsx)(Y.Fragment,{});if(void 0===n||void 0===r)return Object(Y.jsx)(Y.Fragment,{});var s=c[t];if("update"!==s.type)return Object(Y.jsx)(Y.Fragment,{});var i="".concat(s.rank).concat(function(e){var t=e%10,n=e%100;return 1===t&&11!==n?"st":2===t&&12!==n?"nd":3===t&&13!==n?"rd":"th"}(s.rank)),o="solid-".concat(s.user,"-").concat(t);return Object(Y.jsxs)("g",{children:[Object(Y.jsx)("defs",{children:Object(Y.jsxs)("filter",{x:"-0.05",y:"-0.07",width:"1.1",height:"1.1",id:o,children:[Object(Y.jsx)("feFlood",{floodColor:a}),Object(Y.jsx)("feComposite",{in:"SourceGraphic",operator:"xor"})]})}),Object(Y.jsx)("text",{filter:"url(#".concat(o,")"),x:n,y:r-10,fontSize:14,fill:"none",children:i}),Object(Y.jsx)("text",{x:n,y:r-10,fontSize:14,fill:"white",children:i})]})},L=function(e){var t=e.active,n=e.payload,r=e.label;return t&&void 0!==n&&void 0!==r?Object(Y.jsxs)("div",{className:"recharts-default-tooltip",style:{margin:"0px",padding:"10px",backgroundColor:"rgb(255, 255, 255)",border:"1px solid rgb(204, 204, 204)",whiteSpace:"nowrap"},children:[Object(Y.jsx)("p",{className:"recharts-tooltip-label",style:{margin:"0px"},children:T(new Date(1e3*r))}),n.map((function(e){var t=e.payload;if(e.name===t.user&&r===t.time_unix)return Object(Y.jsxs)("div",{children:[Object(Y.jsx)("hr",{style:{marginTop:"0.3em",marginBottom:"0.3em"}}),Object(Y.jsx)("div",{style:{color:e.stroke},children:"User: ".concat(e.name)}),Object(Y.jsx)("ul",{className:"recharts-tooltip-item-list",style:{padding:"0px",margin:"0px"},children:Object(Y.jsxs)("li",{className:"recharts-tooltip-item",style:{display:"block",paddingTop:"4px",paddingBottom:"4px",color:"rgb(136, 132, 216)"},children:[Object(Y.jsx)("span",{className:"recharts-tooltip-item-name",children:"Rank"}),Object(Y.jsx)("span",{className:"recharts-tooltip-item-separator",children:" : "}),Object(Y.jsx)("span",{className:"recharts-tooltip-item-value",children:t.rank}),Object(Y.jsx)("span",{className:"recharts-tooltip-item-unit"})]})}),Object(Y.jsx)("div",{style:{fontSize:10},children:"update"===t.type?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("div",{children:"\u5f97\u70b9\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f:"}),Object(Y.jsx)("div",{children:"".concat(t.oldScore," \u2192 ").concat(t.score," (").concat(t.task," ").concat(t.status,")")})]}):Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("div",{children:"".concat(t.overtakeUserName," \u3055\u3093\u306b\u8ffd\u3044\u629c\u304b\u308c\u307e\u3057\u305f:")}),Object(Y.jsx)("div",{children:"".concat(e.name,": ").concat(t.score)}),Object(Y.jsx)("div",{children:"".concat(t.overtakeUserName,": ").concat(t.overtakeUserOldScore," \u2192 ").concat(t.overtakeUserNewScore," (").concat(t.task," ").concat(t.status,")")})]})})]},e.name)})).filter((function(e){return void 0!==e}))]}):Object(Y.jsx)(Y.Fragment,{})},z=function(e){var t=(e.end_time_unix-e.start_time_unix)/3600,n=3600;n=t<=12?3600:t<=24?7200:t<=72?21600:86400;for(var r=[e.start_time_unix],a=e.start_time_unix-(e.start_time_unix+32400)%n+n;a<e.end_time_unix;a+=n)r.push(a);return r.push(e.end_time_unix),r},q=function(e){var t=(e.end_time_unix-e.start_time_unix)/3600,n="";return n=t<=12||t<=24?"hh:mm":t<=72?"MM/DD hh:mm":"MM/DD",function(e){return T(new Date(1e3*e),n)}},I=["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7D7F7F","#BCBD22","#17BECF"],P=function(e){var t=e.users,n=e.contest,r=e.contestSubmissions,a=e.showDots,c=e.showACLabels;if(!n||0===t.length)return Object(Y.jsx)("div",{style:{height:"50px"}});if(0===r.length)return Object(Y.jsx)("div",{style:{width:"100%",height:"500px",textAlign:"center",marginTop:"100px",marginBottom:"100px"},children:"Fetch data..."});var s=t.map((function(e){return[e,E(e,r)]}));if(s.every((function(e){return 0===e[1].length})))return Object(Y.jsx)("div",{style:{width:"100%",height:"500px",textAlign:"center",marginTop:"100px",marginBottom:"100px"},children:"Invalid UserName"});var i="";if(1===s.length){var o=s[0][1].reduce((function(e,t){return"update"!==t.type||e[1]<t.rank?e:[t.time_unix,t.rank]}),[-1,r.length]),l=Object(j.a)(o,2),u=l[0],h=l[1];i="\n\u6700\u5927\u77ac\u9593\u98a8\u901f\u306f ".concat(h," \u4f4d (").concat(T(new Date(1e3*u),"MM/DD hh:mm"),") \u3060\u3088\uff01")}var d="".concat(t.join(","),"'s replay of ").concat(n.contest_name,"\n").concat(i,"\nAtCoder Marathon Replay");return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsxs)("h4",{style:{textAlign:"center",marginTop:"50px",marginBottom:"-30px"},children:["Replay of ",n.contest_name]}),Object(Y.jsx)("div",{style:{width:"100%",height:"500px",marginTop:"50px"},children:Object(Y.jsx)(v.a,{children:Object(Y.jsxs)(y.a,{width:1e3,height:500,margin:{top:20,right:20,bottom:20,left:20},children:[Object(Y.jsx)(k.a,{strokeDasharray:"3 3"}),Object(Y.jsx)(_.a,{type:"number",dataKey:"time_unix",name:"unixtime",domain:[n.start_time_unix,n.end_time_unix],tickFormatter:q(n),ticks:z(n),children:Object(Y.jsx)(w.a,{value:"Datetime",offset:0,position:"insideBottom"})}),Object(Y.jsx)(S.a,{type:"number",name:"rank",label:{value:"Rank",angle:-90,position:"insideLeft"},reversed:!0}),Object(Y.jsx)(D.a,{content:Object(Y.jsx)(L,{})}),Object(Y.jsx)(C.a,{}),s.map((function(e,t){var n=Object(j.a)(e,2),r=n[0],s=n[1];return Object(Y.jsx)(M.a,{data:s,name:r,dataKey:"rank",type:"stepAfter",stroke:I[t%I.length],dot:a&&{fillOpacity:.2,strokeWidth:1},children:c&&Object(Y.jsx)(F.a,{dataKey:"label",position:"top",content:Object(Y.jsx)(R,{color:I[t%I.length],rankChartDataSequence:s})})},r)}))]})})}),Object(Y.jsx)("div",{style:{textAlign:"center"},children:Object(Y.jsx)(O.a,{url:window.location.href,title:d,children:Object(Y.jsx)(g.a,{size:40,round:!0})})})]})},K=n(46),H=n.n(K),J=n(120),W=function(){var e=Object(J.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0!==t&&t.length>0?fetch("".concat(".","/submissions/").concat(t,".json")).then((function(e){return e.json()})):Promise.resolve([]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(J.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(".","/contests/contests.json")).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=n(355),V=function(e){return"".concat(T(new Date(1e3*e.start_time_unix),"YYYY-MM-DD"),"\u3000").concat(e.contest_name)},X=function(e){var t=e.paramUsers,n=e.paramContest,a=e.contests,c=Object(r.useState)(""!==n?n:"ahc001"),s=Object(j.a)(c,2),o=s[0],l=s[1],u=Object(r.useState)(t),h=Object(j.a)(u,2),f=h[0],O=h[1],g=Object(r.useMemo)((function(){return function(e,t){return"/chart/".concat(e,"/").concat(t)}(o,f)}),[o,f]);return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(d.a,{children:Object(Y.jsx)(p.a,{sm:12,children:Object(Y.jsxs)(x.a,{style:{width:"100%"},children:[Object(Y.jsx)(m.a,{children:"CONTEST:"}),Object(Y.jsx)(b.a,{type:"select",name:"input-contest",id:"input-contest",value:o,onChange:function(e){return l(e.target.value)},children:a.map((function(e){return Object(Y.jsx)("option",{value:e.contest_slug,children:V(e)},e.contest_slug)}))})]})})}),Object(Y.jsx)(d.a,{children:Object(Y.jsx)(p.a,{sm:12,children:Object(Y.jsxs)(x.a,{style:{width:"100%"},children:[Object(Y.jsx)(m.a,{for:"input-user",children:"ATCODER ID (COMMA SEPARATED):"}),Object(Y.jsx)(b.a,{value:f,type:"text",name:"input-user",id:"input-user",placeholder:f||"user1,user2,...",onChange:function(e){return O(e.target.value)}})]})})}),Object(Y.jsx)(d.a,{children:Object(Y.jsx)(p.a,{sm:12,children:Object(Y.jsx)(Q.a,{color:"primary",tag:i.c,to:g,block:!0,children:"Replay!"})})})]})},Z=Object(f.connect)((function(e){return{contestsFetch:{value:G()},contestSubmissionsFetch:{comparison:[e.match.params.contest],value:W(e.match.params.contest)}}}))((function(e){var t,n,a=e.contestsFetch,c=e.contestSubmissionsFetch,s=a.fulfilled?a.value:[],i=c.fulfilled?c.value:[],o=null!==(t=e.match.params.contest)&&void 0!==t?t:"",l=null!==(n=e.match.params.user)&&void 0!==n?n:"",u=Object(r.useState)(!0),h=Object(j.a)(u,2),f=h[0],O=h[1],g=Object(r.useState)(!0),v=Object(j.a)(g,2),y=v[0],k=v[1],_=l.split(",").map((function(e){return e.trim()})).filter((function(e){return""!==e})),w=s.reduce((function(e,t){return e.set(t.contest_slug,t)}),new Map);return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("h2",{children:"Description"}),Object(Y.jsxs)("p",{children:[Object(Y.jsx)("a",{href:"https://atcoder-replay.kakira.dev/",target:"_blank",rel:"noreferrer",children:"AtCoder Replay (\u03b2)"}),"\u304c\u30de\u30e9\u30bd\u30f3\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\uff0e"]}),Object(Y.jsx)("h2",{children:"Let's Replay!"}),Object(Y.jsx)(X,{paramUsers:l,paramContest:o,contests:s}),Object(Y.jsx)(P,{users:_,contest:w.get(o),contestSubmissions:i,showDots:f,showACLabels:y}),Object(Y.jsx)("h2",{children:"Display Options"}),Object(Y.jsxs)("p",{children:[Object(Y.jsx)(d.a,{children:Object(Y.jsx)(p.a,{sm:12,children:Object(Y.jsx)(x.a,{style:{width:"100%"},check:!0,children:Object(Y.jsxs)(m.a,{check:!0,children:[Object(Y.jsx)(b.a,{type:"checkbox",checked:f,onChange:function(e){return O(e.target.checked)}}),"Show Dots"]})})})}),Object(Y.jsx)(d.a,{children:Object(Y.jsx)(p.a,{sm:12,children:Object(Y.jsx)(x.a,{style:{width:"100%"},check:!0,children:Object(Y.jsxs)(m.a,{check:!0,children:[Object(Y.jsx)(b.a,{type:"checkbox",checked:y,onChange:function(e){return k(e.target.checked)}}),"Show AC Labels"]})})})})]}),Object(Y.jsx)("h2",{children:"\u88dc\u8db3"}),Object(Y.jsx)("p",{children:"AHC001 \u306f\u6700\u7d42\u63d0\u51fa\u306e\u30d7\u30ec\u30c6\u30b9\u30c8\u5f97\u70b9\u4e0d\u660e\u306b\u3064\u304d\uff0c\u5404\u30e6\u30fc\u30b6\u306e\u6700\u7d42\u63d0\u51fa\u306e\u30b9\u30b3\u30a2\u306f\uff0c\u30b7\u30b9\u30c6\u30b9\u7d50\u679c * 50 / 1000 \u3092\u7528\u3044\u3066\u3044\u307e\u3059\uff0e"}),Object(Y.jsx)("p",{children:"\u65e5\u7acb\u5317\u59272020 \u306f\u6700\u7d42\u63d0\u51fa\u306e\u30d7\u30ec\u30c6\u30b9\u30c8\u5f97\u70b9\u4e0d\u660e\u306b\u3064\u304d\uff0c\u5404\u30e6\u30fc\u30b6\u306e\u6700\u7d42\u63d0\u51fa\u306e\u30b9\u30b3\u30a2\u306f\uff0c\u30b7\u30b9\u30c6\u30b9\u7d50\u679c * 16 / 200 \u3092\u7528\u3044\u3066\u3044\u307e\u3059\uff0e"})]})}));var $=function(){return Object(Y.jsx)("div",{className:"App",children:Object(Y.jsxs)(i.a,{children:[Object(Y.jsx)(l.a,{color:"light",light:!0,expand:"lg",fixed:"top",children:Object(Y.jsx)(u.a,{tag:i.b,to:"/",children:"AtCoder Marathon Replay"})}),Object(Y.jsx)(h.a,{style:{width:"100%",maxWidth:"90%",marginTop:"80px"},children:Object(Y.jsxs)(o.d,{children:[Object(Y.jsx)(o.b,{exact:!0,path:"/chart/:contest/:user",component:Z}),Object(Y.jsx)(o.b,{exact:!0,path:"/chart/",component:Z}),Object(Y.jsx)(o.a,{path:"/",to:"/chart/"})]})}),Object(Y.jsx)("footer",{className:"footer",style:{marginTop:"30px",padding:"30px",backgroundColor:"#efefef"},children:Object(Y.jsxs)("div",{className:"container",children:["\u9023\u7d61\u5148: ",Object(Y.jsx)("a",{href:"https://twitter.com/iiljj",children:"si (@iiljj) / Twitter"})]})})]})})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,363)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(Y.jsx)(a.a.StrictMode,{children:Object(Y.jsx)($,{})}),document.getElementById("root")),ee()}},[[342,1,2]]]);
//# sourceMappingURL=main.9a6cdad3.chunk.js.map